<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:composition>
	<h:outputScript name="js/buscador.js" />
	<script type="text/javascript" 
    		src="http://maps.googleapis.com/maps/api/js?sensor=true">
    	</script>
		<h:outputScript library="js" name="mapa.js"/>
		
		<script type="text/javascript" src="jquery-1.7.1.min.js"></script>
		
		
	<div class="container-fluid">
			<div id="mapa" style="width:1000px; height:500px"></div>
		<h:outputScript>
			mapa("mapa", -32.916277, -56.060646, 6);
		</h:outputScript>
		<h:form>
			<ui:repeat value="#{reporteUsuariosBean.listDataUsuarios}" var="c">
				<h:outputScript>
					var marca#{c.idUsuario} = agregarMarca(#{c.latitud}, #{c.longitud}, '#{c.email}');
					agregarCirculos(marca#{c.idUsuario},#{0});
					var contenido = '<container><row>' +
						'<column span="3"><h:graphicImage class="img-responsive" id="idima"
						value="Image/#{c.idFoto}" >
						
					</h:graphicImage></column>' +
						//'<column span="3"></column>' +
						'<column span="6"><p>#{c.email}</p></column>' +
						'<column span="3"></column>' +
						'</row><row>' + 
						'<column span="3"></column>' + 
						'<column span="9">#{c.nombre}</column>' +
						'</row></container>';
					agregarVentana(contenido, marca#{c.idUsuario});
				</h:outputScript>
			</ui:repeat>
		</h:form>
	
	</div>
	
	
	
	
	  <div id='map_canvas' style='width:100%; height:400px;'></div>
	  
	  <script type="text/javascript">
        var map;
        var latitud;
        var longitud;
        
        $(document).ready(function() {
            localizame(); /*Cuando cargue la página, cargamos nuestra posición*/   
        });
        
        function localizame() {
            if (navigator.geolocation) { /* Si el navegador tiene geolocalizacion */
                navigator.geolocation.getCurrentPosition(coordenadas, errores);
            }else{
                alert('Oops! Tu navegador no soporta geolocalización. Bájate Chrome, que es gratis!');
            }
        }
        
        function coordenadas(position) {
            latitud = position.coords.latitude; /*Guardamos nuestra latitud*/
            longitud = position.coords.longitude; /*Guardamos nuestra longitud*/
            cargarMapa();
        }
        
        function errores(err) {
            /*Controlamos los posibles errores */
            if (err.code == 0) {
              alert("Oops! Algo ha salido mal");
            }
            if (err.code == 1) {
              alert("Oops! No has aceptado compartir tu posición");
            }
            if (err.code == 2) {
              alert("Oops! No se puede obtener la posición actual");
            }
            if (err.code == 3) {
              alert("Oops! Hemos superado el tiempo de espera");
            }
        }
         
        function cargarMapa() {
            var latlon = new google.maps.LatLng(latitud,longitud); /* Creamos un punto con nuestras coordenadas */
            var myOptions = {
                zoom: 17,
                center: latlon, /* Definimos la posicion del mapa con el punto */
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };/*Configuramos una serie de opciones como el zoom del mapa y el tipo.*/
            map = new google.maps.Map($("#map_canvas").get(0), myOptions); /*Creamos el mapa y lo situamos en su capa */
            $('#latitud').val(latitud);
            $('#longitud').val(longitud);
            var coorMarcador = new google.maps.LatLng(latitud,longitud); /*Un nuevo punto con nuestras coordenadas para el marcador (flecha) */
                
            var marcador = new google.maps.Marker({
/*Creamos un marcador*/
                position: coorMarcador, /*Lo situamos en nuestro punto */
                map: map, /* Lo vinculamos a nuestro mapa */
                title: "Dónde estoy?" 
            });
        }
    </script>
    <input id="latitud"/>
    <input id="longitud"/>
    
</ui:composition>
</html>